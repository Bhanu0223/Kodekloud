After conducting a security audit within the Stratos DC, the Nautilus security team discovered misconfigured permissions on critical files. To address this, corrective actions are being taken by the production support team. Specifically, the file named /etc/hosts on Nautilus App 1 server requires adjustments to its Access Control Lists (ACLs) as follows:


1. The file's user owner and group owner should be set to root.

2. Others should possess read only permissions on the file.

3. User mark must not have any permissions on the file.

4. User garrett should be granted read only permission on the file.



#################

First, make sure the base ownership and permissions are correct.

sudo chown root:root /etc/hosts
sudo chmod 644 /etc/hosts


This ensures:

Owner = root

Group = root

Permissions = rw-r--r--
(Owner: read/write, Group: read, Others: read)

Now apply the ACL rules:

sudo setfacl -m u:mark:0 /etc/hosts
sudo setfacl -m u:garrett:r /etc/hosts


What these do:

u:mark:0 ‚Üí user mark gets no permissions

u:garrett:r ‚Üí user garrett gets read-only permission

Verify the result:

getfacl /etc/hosts


You should see entries similar to:

# file: etc/hosts
# owner: root
# group: root
user::rw-
user:mark:---
user:garrett:r--
group::r--
mask::r--
other::r--


This satisfies all the requirements:

Owner and group are root

Others have read-only access

mark has no permissions

garrett has read-only permission


########################
Configure crontab access on App Server 1 as follows: Allow crontab access to rose user while denying access to the eric user.

sol: To configure crontab access on App Server 1 so that:

‚úÖ rose ‚Üí allowed

‚ùå eric ‚Üí denied

Linux uses /etc/cron.allow and /etc/cron.deny for this.

‚úÖ Correct & Recommended Method
1Ô∏è‚É£ Login to App Server 1
ssh user@app_server_1

2Ô∏è‚É£ Create /etc/cron.allow and allow rose
echo "rose" | sudo tee /etc/cron.allow

3Ô∏è‚É£ Create /etc/cron.deny and deny eric
echo "eric" | sudo tee /etc/cron.deny

4Ô∏è‚É£ Set correct permissions (important)
sudo chown root:root /etc/cron.allow /etc/cron.deny
sudo chmod 600 /etc/cron.allow /etc/cron.deny

üîç How It Works (Important Rule)

If /etc/cron.allow exists ‚Üí ONLY users listed can use crontab

/etc/cron.deny is checked only if cron.allow does NOT exist

Root can always use crontab

In your case:

rose is explicitly allowed ‚úÖ

eric is blocked ‚ùå

üß™ Verification (Optional)
Switch user and test
su - rose
crontab -e     # should work

su - eric
crontab -e     # should be denied

‚úÖ Final State Summary
User	Crontab Access
rose	‚úÖ Allowed
eric	‚ùå Denied

